# AI-Hydra Design System

## Цветовые токены

### Базовые
- `background` / `foreground` — основной фон и текст
- `card` / `card-foreground` — карточки
- `primary` / `primary-foreground` — акцентные элементы (cyan)
- `secondary` / `secondary-foreground` — вторичные элементы
- `muted` / `muted-foreground` — приглушённые элементы
- `destructive` / `destructive-foreground` — опасные действия

### Hydra-специфичные
- `hydra-glow` — неоновое свечение (cyan)
- `hydra-success` — успех (зелёный)
- `hydra-warning` — предупреждение (жёлтый)
- `hydra-critical` — критично (красный)

### AI-роли
| Роль | Токен | Цвет |
|------|-------|------|
| Ассистент | `hydra-success` | Зелёный |
| Критик | `hydra-critical` | Красный |
| Арбитр | `hydra-arbiter` | Золотой |
| Консультант | `hydra-consultant` | Янтарный |
| Модератор | `hydra-moderator` | Синий |
| Советник | `hydra-advisor` | Изумрудный |
| Архивист | `hydra-archivist` | Бронзовый |
| Аналитик | `hydra-analyst` | Индиго |
| Вебхантер | `hydra-webhunter` | Оранжевый |
| Эксперт | `hydra-expert` | Фиолетовый |

## Использование

### В Tailwind
```tsx
// Правильно — используем токены
<div className="bg-primary text-primary-foreground" />
<span className="text-hydra-success" />
<div className="border-hydra-glow" />

// Неправильно — прямые цвета
<div className="bg-cyan-500" /> // ❌
<span className="text-green-400" /> // ❌
```

### В CSS
```css
.my-element {
  background: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
  border-color: hsl(var(--hydra-glow));
}
```

## Шрифты
- `font-sans` — Inter (основной)
- `font-mono` — JetBrains Mono (код)
- `font-rounded` — Quicksand (заголовки, лого)

## Анимации
- `animate-pulse-glow` — пульсирующее свечение
- `animate-fade-in` — плавное появление
- `animate-slide-up` — появление снизу

## Компоненты

### Свечение
```tsx
<Button className="hydra-glow" />     // Полное свечение
<Button className="hydra-glow-sm" />  // Слабое свечение
```

### Скроллбар
```tsx
<ScrollArea className="hydra-scrollbar" />
```

## «Мысли шире» — чеклист целостности

Протокол активируется командой **«Лав, мысли шире»** при любой задаче.
Цель: проверить контракты между слоями параллельно с основной работой.

### 1. Типы и интерфейсы
- [ ] Новый параметр добавлен в интерфейс → используется ли он во всех потребителях?
- [ ] Удалённое поле убрано из всех мест (компоненты, хуки, edge functions)?
- [ ] Опциональные поля (`?`) действительно опциональны, а не «забыли передать»?

### 2. Пропсы и компоненты
- [ ] Компонент принимает проп → рендерит/использует его?
- [ ] Проп передаётся из родителя → он реально существует в источнике?
- [ ] Деструктуризация пропсов совпадает с интерфейсом?

### 3. API-контракты (клиент ↔ edge function)
- [ ] Edge function принимает параметр → клиент его отправляет?
- [ ] Клиент отправляет данные → edge function их читает и использует?
- [ ] Формат ответа edge function совпадает с тем, что парсит клиент?

### 4. Состояние и побочные эффекты
- [ ] Состояние обновляется → UI реагирует на изменение?
- [ ] useEffect зависимости корректны (нет stale closures)?
- [ ] Очистка (cleanup) вызывается при размонтировании?

### 5. Локализация
- [ ] Новые строки добавлены и для `ru`, и для `en`?
- [ ] Нет инлайновых строк на одном языке (кроме fallback)?
- [ ] Используется `language === 'ru'`, а не `t('common.locale')`?

### 6. Критерий «достаточно хорошо»
> Не рефакторить стабильный код без причины. Изменение оправдано, если:
> - Есть воспроизводимый баг
> - Нарушен контракт между слоями
> - Дублирование приводит к рассинхрону
> - Пользователь явно запросил улучшение

### 7. Кросс-модульные архитектурные контракты

> **Перед реализацией любой задачи** агент ОБЯЗАН проверить, не затрагивает ли она
> существующие контракты. При команде «Лав, мысли шире» — полный аудит.

#### Обязательные контракты (MUST)

| Контракт | Правило | Модули-потребители |
|----------|---------|-------------------|
| **Выбор модели** | Любой модуль, отправляющий запрос к AI, ОБЯЗАН использовать `getModelInfo()` из `useAvailableModels` для определения `use_lovable_ai` и провайдера | СПРЗ (`useConceptInvoke`), Чат (`hydra-orchestrator`), Конкурсы, Собеседования |
| **Приоритет провайдеров** | Иерархия: Lovable AI → BYOK → OpenRouter → ProxyAPI/DotPoint. Флаг `proxyapi_priority` из профиля определяет порядок внешних шлюзов | Edge functions: `hydra-orchestrator`, `contest-*`, `interview-*` |
| **Поисковый провайдер** | Определяется через `get_my_api_key_status` (Tavily/Perplexity). Системный fallback: Tavily | СПРЗ, Чат (tool-вызовы) |
| **Локализация** | Проверка `language === 'ru'`, **не** через `t('locale')`. Новые строки — и для `ru`, и для `en` | Все UI-компоненты |
| **Дизайн-токены** | Запрещены прямые цвета (`text-white`, `bg-cyan-500`). Только семантические токены из `index.css` | Все компоненты |

#### Как добавить новый контракт
1. Добавь строку в таблицу выше
2. Обнови соответствующую memory-ноту с пометкой `ОБЯЗАН / MUST`
3. Перечисли все модули-потребители — это триггер для кросс-проверки
```
